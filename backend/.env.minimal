#
# MINIMAL COST PRODUCTION ENVIRONMENT
# For solo artists / bootstrapped launch (€5-15/month)
#
# Copy this to .env and fill in your actual values
#

# ================================
# ENVIRONMENT
# ================================
NODE_ENV=production
PORT=3000

# ================================
# SUPABASE (FREE TIER - 500MB)
# ================================
# Get from: https://supabase.com/dashboard/project/_/settings/api
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGc...
SUPABASE_SERVICE_KEY=eyJhbGc...  # Keep secret!

# Direct database connection (for backups)
SUPABASE_DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.xxxxx.supabase.co:5432/postgres

# FREE TIER LIMITS:
# - 500MB Database
# - 1GB File Storage
# - 50k Monthly Active Users
# - 2GB Bandwidth
# UPGRADE AT: ~500-1,000 users

# ================================
# JWT & SECURITY
# ================================
# Generate with: openssl rand -hex 32
JWT_SECRET=your_super_secret_jwt_key_change_this_to_random_64_chars

# Session expiry
JWT_EXPIRY=7d

# CORS origins (comma-separated)
CORS_ORIGINS=https://echoelmusic.com,https://www.echoelmusic.com

# ================================
# STRIPE (FREE - Pay 2.9% + €0.30)
# ================================
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_...
STRIPE_PUBLISHABLE_KEY=pk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Product IDs (create in Stripe Dashboard)
STRIPE_PRO_PRICE_ID=price_...
STRIPE_STUDIO_PRICE_ID=price_...

# ================================
# AWS S3 (FREE TIER - 12 months)
# ================================
# Get from: AWS IAM Console
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=eu-central-1
AWS_S3_BUCKET=echoelmusic-storage

# FREE TIER (12 months):
# - 5GB storage
# - 20k GET requests
# - 2k PUT requests
# COST AFTER: ~€0.50/month for 10GB

# ALTERNATIVE: Backblaze B2 (cheaper long-term)
# B2_APPLICATION_KEY_ID=...
# B2_APPLICATION_KEY=...
# B2_BUCKET_ID=...
# B2_BUCKET_NAME=echoelmusic-storage
# FREE: 10GB forever, €0.005/GB after

# ================================
# EMAIL (FREE - Gmail forwarding)
# ================================
# For transactional emails, use SendGrid free tier
SENDGRID_API_KEY=SG.xxxxx  # Optional - 100 emails/day free

# From address (your domain)
EMAIL_FROM=hello@echoelmusic.com
EMAIL_SUPPORT=support@echoelmusic.com

# SMTP fallback (optional)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=hello@echoelmusic.com
# SMTP_PASS=your_app_specific_password

# ================================
# ANALYTICS (FREE TIER)
# ================================
# Mixpanel: https://mixpanel.com
MIXPANEL_TOKEN=xxxxx  # Free: 100k events/month, 1k MTU

# FREE TIER:
# - 100,000 tracked events/month
# - 1,000 Monthly Tracked Users
# - 90-day retention
# UPGRADE AT: ~1,000 users or 100k events

# Alternative: Plausible (€9/month, privacy-first)
# PLAUSIBLE_API_KEY=xxxxx
# PLAUSIBLE_DOMAIN=echoelmusic.com

# ================================
# ERROR TRACKING (FREE TIER)
# ================================
# Sentry: https://sentry.io
SENTRY_DSN=https://xxxxx@o123456.ingest.sentry.io/123456

# FREE TIER:
# - 5,000 errors/month
# - 30-day retention
# - Email alerts
# UPGRADE AT: >5k errors/month (fix bugs first!)

# ================================
# MONITORING (FREE TIER)
# ================================
# UptimeRobot: Setup via website (no API key needed for basic)
# Free: 50 monitors, 5-min checks

# Health check endpoint
HEALTH_CHECK_SECRET=your_random_string_for_health_checks

# ================================
# RATE LIMITING
# ================================
# Protect your free tiers from abuse!
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100  # 100 requests per 15 min
RATE_LIMIT_MESSAGE=Too many requests, please try again later

# ================================
# REDIS (OPTIONAL - €0 if not used)
# ================================
# For caching & rate limiting
# Upstash Redis has FREE tier: 10k commands/day
# REDIS_URL=redis://default:xxxxx@xxxxx.upstash.io:6379

# Or use in-memory fallback (no Redis needed)
USE_MEMORY_CACHE=true

# ================================
# BACKUP & MAINTENANCE
# ================================
# S3 bucket for database backups
BACKUP_S3_BUCKET=echoelmusic-backups
BACKUP_RETENTION_DAYS=30

# Backup schedule (handled by cron)
BACKUP_ENABLED=true

# ================================
# NOTIFICATIONS (FREE)
# ================================
# Slack webhook for alerts (optional but recommended!)
SLACK_WEBHOOK=https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX

# Alert email (fallback)
ALERT_EMAIL=michaelterbuyken@gmail.com

# ================================
# APPLE & GOOGLE (FREE)
# ================================
# For receipt validation

# Apple App Store
APPLE_SHARED_SECRET=xxxxx  # From App Store Connect

# Google Play
GOOGLE_PLAY_SERVICE_ACCOUNT_EMAIL=xxxxx@xxxxx.iam.gserviceaccount.com
GOOGLE_PLAY_SERVICE_ACCOUNT_KEY_PATH=./google-play-service-account.json

# ================================
# FEATURE FLAGS
# ================================
# Disable expensive features for free tier users
ENABLE_VIDEO_EXPORT=false  # CPU-intensive
ENABLE_AI_FEATURES=true
ENABLE_CLOUD_SYNC=true
MAX_PROJECT_SIZE_MB=100  # Limit to save storage

# Free tier limits
FREE_TIER_MAX_PROJECTS=10
PRO_TIER_MAX_PROJECTS=100
STUDIO_TIER_MAX_PROJECTS=-1  # unlimited

# ================================
# OPTIMIZATION
# ================================
# Compress API responses
ENABLE_COMPRESSION=true

# Cache static assets (seconds)
STATIC_CACHE_TTL=31536000  # 1 year

# API response cache (seconds)
API_CACHE_TTL=300  # 5 minutes

# ================================
# COSTS TRACKING (Optional)
# ================================
# Set budget alerts
MONTHLY_BUDGET_EUR=20
ALERT_AT_PERCENTAGE=80  # Alert at 80% of budget

# ================================
# NOTES FOR MINIMAL COST DEPLOYMENT
# ================================
#
# TOTAL COST: ~€5-15/month
#
# INCLUDED (FREE):
# ✅ Supabase (500MB DB + 1GB storage)
# ✅ AWS S3 (5GB, 12 months free, then ~€0.50/month)
# ✅ Mixpanel (100k events/month)
# ✅ Sentry (5k errors/month)
# ✅ UptimeRobot (50 monitors)
# ✅ GitHub Actions (2,000 min/month)
# ✅ Mailchimp (500 contacts, 1k emails/month)
#
# PAID:
# - Domain: €1/month (€12/year)
# - Server (Hetzner CX11): €4/month
# - GitHub Actions overage: €0-5/month
# - S3 overage: €0-2/month
# - Analytics (Plausible): €0-9/month (optional)
#
# WHEN TO UPGRADE:
# - Supabase DB > 400MB → Pro (€25/month)
# - Users > 500 → Bigger server (€9/month)
# - Events > 100k/month → Mixpanel paid (€20/month)
# - Support tickets > 50/month → Intercom (€50/month)
#
